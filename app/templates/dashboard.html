<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <title>ğŸª– ì „ì°¨ ì „íˆ¬ ëŒ€ì‹œë³´ë“œ</title>
    <link rel="stylesheet" href="/static/css/style.css" />
    <style>
      #live-image {
        max-width: 100%;
        border: 1px solid #444;
        margin-top: 1rem;
      }
    </style>
  </head>
  <body>
    <!-- âœ… íƒì§€ ì´ë¯¸ì§€ (ì¡°ì¤€ì„  í¬í•¨) -->
    <div style="margin-top: 2rem">
      <h3>ğŸ“¸ ìµœì‹  íƒì§€ ì´ë¯¸ì§€</h3>
      <img id="live-image" src="/tmp/temp_image.jpg" alt="íƒì§€ ê²°ê³¼" />
    </div>

    <!-- âœ… HUD íŒ¨ë„ -->
    <div class="hud">
      <div class="hud-item" id="speed">ì†ë„: 0 km/h</div>
      <div class="hud-item" id="health">
        <div>ì „ì°¨ ì²´ë ¥</div>
        <div class="health-bar">
          <div id="health-fill" class="health-fill"></div>
        </div>
        <div id="health-text">100%</div>
      </div>
      <div class="hud-item danger" id="threat">ğŸš¨ ìœ„í˜‘ ê°ì§€: ì—†ìŒ</div>
      <div class="hud-item" id="comm">
        <div>ğŸ“¡ í†µì‹  ì‹ í˜¸</div>
        <div class="signal-bar">
          <div class="bar" id="bar1"></div>
          <div class="bar" id="bar2"></div>
          <div class="bar" id="bar3"></div>
          <div class="bar" id="bar4"></div>
        </div>
      </div>
      <div class="hud-item" id="position">ì¢Œí‘œ: ì—†ìŒ</div>
      <div class="hud-item" id="gear">
        ğŸ”§ ê¸°ì–´: <span id="gear-level">2</span>
      </div>
    </div>

    <!-- âœ… ì•Œë¦¼ì°½ -->
    <div id="alert-box" class="alert hidden">ì•Œë¦¼ì°½</div>

    <!-- âœ… ëª©ì ì§€ ì…ë ¥ ë° ì œì–´ -->
    <div class="command-panel">
      <input type="text" id="destInput" placeholder="x,y,z" />
      <button onclick="sendDestination()">ğŸ“ ëª©ì ì§€ ì„¤ì •</button>

      <!-- ğŸ”« í¬íƒ‘ íšŒì „ ë° ë°œì‚¬ -->
      <form method="post" action="/send_action" style="margin-top: 1rem">
        <input type="hidden" name="turret" value="ROTATE" />
        <input type="hidden" name="weight" value="1.0" />
        <button type="submit">ğŸŒ€ í¬íƒ‘ íšŒì „</button>
      </form>
      <button onclick="sendBullet()">ğŸ’¥ ë°œì‚¬</button>
    </div>

    <!-- âœ… í‚¤ë³´ë“œ ì…ë ¥ ì œì–´ëŠ” JSì—ì„œ ì²˜ë¦¬ -->
    <script>
      document.addEventListener("keydown", (event) => {
        const key = event.key.toUpperCase();
        const validKeys = ["W", "A", "S", "D", "P", "L"];
        if (!validKeys.includes(key)) return;

        const formData = new FormData();
        formData.append("key", key);
        fetch("/input_key", {
          method: "POST",
          body: formData,
        })
          .then((res) => res.json())
          .then((data) => {
            updateGearUI(data.gear);
            showAlert(`ğŸ”§ ${key} ì…ë ¥ë¨ (ê¸°ì–´ ${data.gear})`, "success");
          });
      });
    </script>

    <!-- âœ… ë‚˜ë¨¸ì§€ JS ë¡œì§ ë¶„ë¦¬ -->
    <script src="/static/js/dashboard.js"></script>
  </body>
</html>
